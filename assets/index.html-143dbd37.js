import{_ as r,M as o,p as c,q as u,R as n,t as s,N as a,V as i,a1 as e}from"./framework-5866ffd3.js";const d={},k=n("h1",{id:"backend-development-45min",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#backend-development-45min","aria-hidden":"true"},"#"),s(" Backend development (45min)")],-1),m={href:"https://spring.io/blog/2017/01/04/introducing-kotlin-support-in-spring-framework-5-0",target:"_blank",rel:"noopener noreferrer"},v={href:"https://quarkus.io/guides/kotlin",target:"_blank",rel:"noopener noreferrer"},g={href:"https://github.com/ktorio/ktor",target:"_blank",rel:"noopener noreferrer"},h={href:"https://kotlinlang.org/docs/server-overview.html#deploying-kotlin-server-side-applications",target:"_blank",rel:"noopener noreferrer"},b={href:"https://medium.com/@touskar/une-application-nodejs-avec-kotlin-1969994fb1d2",target:"_blank",rel:"noopener noreferrer"},f=n("h2",{id:"ktor",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#ktor","aria-hidden":"true"},"#"),s(" Ktor")],-1),y=n("p",null,"Ktor is a cross-platform Kotlin library for building both HTTP clients and servers. This makes Ktor a useful library to learn for both front-end developers for its HTTP client capabilities and backend-development for its HTTP server capabilities. In the following, we'll create a REST API with Ktor server.",-1),_=n("h3",{id:"pw-develop-an-api-with-ktor",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#pw-develop-an-api-with-ktor","aria-hidden":"true"},"#"),s(" PW: develop an API with Ktor")],-1),w={href:"https://start.ktor.io/",target:"_blank",rel:"noopener noreferrer"},q=e("<li>Click on &quot;Generate project&quot;.</li><li>Download the archive, unzip it, and open the project with IntelliJ.</li><li>Create a <code>models</code> package and add to it a <code>Customer</code> data class with these immutable properties <code>id: String, firstName: String, lastName: String, email: String</code>.</li><li>Annotate the class with <code>@Serializable</code>.</li><li>Create a new package named <code>routes</code> and add to it a file <code>CustomerRoutes.kt</code> that will contain the code for the <code>/customer</code> endpoint.</li><li>The code below provides the implementation of some endpoints. Please implement the remaining ones.</li><li>To enable the route call <code>customerRouting()</code> in the routing configuration file located in <code>plugins/Routing.kt</code>.</li><li>For simplicity, use a global in-memory list of customers <code>val customerStorage = mutableListOf&lt;Customer&gt;()</code>.</li><li>Run the server by running the main method.</li><li>Test the api on the IDE by using an http file or using any other client.</li>",10),S=e(`<details class="custom-container details"><summary>CustomerRoutes.kt</summary><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code><span class="token keyword">val</span> store <span class="token operator">=</span> mutableListOf<span class="token operator">&lt;</span>Customer<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">fun</span> Route<span class="token punctuation">.</span><span class="token function">customerRouting</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">route</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;/customer&quot;</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">get</span> <span class="token punctuation">{</span>
            call<span class="token punctuation">.</span><span class="token function">respond</span><span class="token punctuation">(</span>store<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;{id?}&quot;</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">val</span> id <span class="token operator">=</span> call<span class="token punctuation">.</span>parameters<span class="token punctuation">[</span><span class="token string-literal singleline"><span class="token string">&quot;id&quot;</span></span><span class="token punctuation">]</span> <span class="token operator">?:</span> <span class="token keyword">return</span>@<span class="token keyword">get</span> call<span class="token punctuation">.</span><span class="token function">respondText</span><span class="token punctuation">(</span>
                <span class="token string-literal singleline"><span class="token string">&quot;Missing id&quot;</span></span><span class="token punctuation">,</span>
                status <span class="token operator">=</span> HttpStatusCode<span class="token punctuation">.</span>BadRequest
            <span class="token punctuation">)</span>
            <span class="token keyword">val</span> customer <span class="token operator">=</span>
                store<span class="token punctuation">.</span><span class="token function">find</span> <span class="token punctuation">{</span> it<span class="token punctuation">.</span>id <span class="token operator">==</span> id <span class="token punctuation">}</span> <span class="token operator">?:</span> <span class="token keyword">return</span>@<span class="token keyword">get</span> call<span class="token punctuation">.</span><span class="token function">respondText</span><span class="token punctuation">(</span>
                    <span class="token string-literal singleline"><span class="token string">&quot;No customer with id </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$</span><span class="token expression">id</span></span><span class="token string">&quot;</span></span><span class="token punctuation">,</span>
                    status <span class="token operator">=</span> HttpStatusCode<span class="token punctuation">.</span>NotFound
                <span class="token punctuation">)</span>
            call<span class="token punctuation">.</span><span class="token function">respond</span><span class="token punctuation">(</span>customer<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        post <span class="token punctuation">{</span>
            <span class="token keyword">val</span> customer <span class="token operator">=</span> call<span class="token punctuation">.</span>receive<span class="token operator">&lt;</span>Customer<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            store<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>customer<span class="token punctuation">)</span>
            call<span class="token punctuation">.</span><span class="token function">respondText</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;Customer stored correctly&quot;</span></span><span class="token punctuation">,</span> status <span class="token operator">=</span> HttpStatusCode<span class="token punctuation">.</span>Created<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        <span class="token function">delete</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;{id?}&quot;</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></details><details class="custom-container details"><summary>plugins/Routing.kt</summary><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code><span class="token keyword">fun</span> Application<span class="token punctuation">.</span><span class="token function">configureRouting</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    routing <span class="token punctuation">{</span>
        <span class="token function">customerRouting</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></details>`,2),I={class:"custom-container tip"},x=e(`<p class="custom-container-title">return@label</p><p>You can specify which level you want to return with an explicit label using <code>return@lambda</code>.</p><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code>lambdaA <span class="token punctuation">{</span>
    lambdaB <span class="token punctuation">{</span>
        lambdaC <span class="token punctuation">{</span>
            <span class="token keyword">val</span> randomInt <span class="token operator">=</span> Random<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>randomInt <span class="token operator">&gt;</span> <span class="token number">50</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token label symbol">@lambdaC</span> <span class="token keyword">else</span> <span class="token keyword">return</span><span class="token label symbol">@lambdaB</span>
        <span class="token punctuation">}</span>
        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;In lambdaB&quot;</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,3),C={href:"https://play.kotlinlang.org/#eyJ2ZXJzaW9uIjoiMS43LjEwIiwicGxhdGZvcm0iOiJqYXZhIiwiYXJncyI6IiIsIm5vbmVNYXJrZXJzIjp0cnVlLCJ0aGVtZSI6ImlkZWEiLCJjb2RlIjoiaW1wb3J0IGtvdGxpbi5yYW5kb20uUmFuZG9tXG5cbi8vIHJldHVybiB3aXRoIGltcGxpY2l0IGxhYmVsc1xuXG5mdW4gbWFpbigpIHtcbiAgIHZhbCBrb3RsaW4gPSBcIvCfmYJcIlxuICAga290bGluLmxldCB7XG4gICAgICAgaXQuYXBwbHkge1xuXHRcdFx0dmFsIHJhbmRvbUludCA9IFJhbmRvbS5uZXh0SW50KDAsIDEwMClcbiAgICAgICAgICAgIHByaW50bG4ocmFuZG9tSW50KVxuICAgICAgICAgICAgaWYgKHJhbmRvbUludCA+IDUwKSByZXR1cm5AYXBwbHkgZWxzZSByZXR1cm5AbGV0XG4gICAgICAgfVxuICAgICAgIHByaW50bG4oXCJpbnQgbGV0IGFmdGVyIGFwcGx5XCIpXG4gICB9XG59In0=",target:"_blank",rel:"noopener noreferrer"},T=e(`<details class="custom-container details"><summary>CustomerTest.http</summary><div class="language-http line-numbers-mode" data-ext="http"><pre class="language-http"><code>POST http://127.0.0.1:8080/customer
<span class="token header"><span class="token header-name keyword">Content-Type</span><span class="token punctuation">:</span> <span class="token header-value">application/json</span></span>
<span class="token application-json">
<span class="token punctuation">{</span>
  <span class="token string-property property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;100&quot;</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;firstName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Jane&quot;</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;lastName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Smith&quot;</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;email&quot;</span><span class="token operator">:</span> <span class="token string">&quot;jane.smith@company.com&quot;</span>
<span class="token punctuation">}</span>


###
<span class="token constant">POST</span> <span class="token literal-property property">http</span><span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token operator">:</span><span class="token number">8080</span><span class="token operator">/</span>customer
Content<span class="token operator">-</span>Type<span class="token operator">:</span> application<span class="token operator">/</span>json

<span class="token punctuation">{</span>
  <span class="token string-property property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;200&quot;</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;firstName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;John&quot;</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;lastName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Smith&quot;</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;email&quot;</span><span class="token operator">:</span> <span class="token string">&quot;john.smith@company.com&quot;</span>
<span class="token punctuation">}</span>

###
<span class="token constant">POST</span> <span class="token literal-property property">http</span><span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token operator">:</span><span class="token number">8080</span><span class="token operator">/</span>customer
Content<span class="token operator">-</span>Type<span class="token operator">:</span> application<span class="token operator">/</span>json

<span class="token punctuation">{</span>
  <span class="token string-property property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;300&quot;</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;firstName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Mary&quot;</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;lastName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Smith&quot;</span><span class="token punctuation">,</span>
  <span class="token string-property property">&quot;email&quot;</span><span class="token operator">:</span> <span class="token string">&quot;mary.smith@company.com&quot;</span>
<span class="token punctuation">}</span>


###
<span class="token constant">GET</span> <span class="token literal-property property">http</span><span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token operator">:</span><span class="token number">8080</span><span class="token operator">/</span>customer
<span class="token literal-property property">Accept</span><span class="token operator">:</span> application<span class="token operator">/</span>json

###
<span class="token constant">GET</span> <span class="token literal-property property">http</span><span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token operator">:</span><span class="token number">8080</span><span class="token operator">/</span>customer<span class="token operator">/</span><span class="token number">200</span>
<span class="token literal-property property">Accept</span><span class="token operator">:</span> application<span class="token operator">/</span>json

###
<span class="token constant">GET</span> <span class="token literal-property property">http</span><span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token operator">:</span><span class="token number">8080</span><span class="token operator">/</span>customer<span class="token operator">/</span><span class="token number">500</span>
<span class="token literal-property property">Accept</span><span class="token operator">:</span> application<span class="token operator">/</span>json

###
<span class="token constant">DELETE</span> <span class="token literal-property property">http</span><span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token operator">:</span><span class="token number">8080</span><span class="token operator">/</span>customer<span class="token operator">/</span><span class="token number">100</span>

###
<span class="token constant">DELETE</span> <span class="token literal-property property">http</span><span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token operator">:</span><span class="token number">8080</span><span class="token operator">/</span>customer<span class="token operator">/</span><span class="token number">500</span>
</span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></details>`,1),P={href:"https://ktor.io/docs/creating-http-apis.html",target:"_blank",rel:"noopener noreferrer"},A=n("h2",{id:"nodejs",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#nodejs","aria-hidden":"true"},"#"),s(" nodejs")],-1),j=n("p",null,"Thanks to Kotlin/JS, we can write apps that targets nodejs using Kotlin.",-1),R=n("strong",null,"external declaration",-1),E={href:"https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.js/-js-module/",target:"_blank",rel:"noopener noreferrer"},G={href:"https://kotlinlang.org/api/latest/jvm/stdlib/kotlin.js/-js-non-module/",target:"_blank",rel:"noopener noreferrer"},J={href:"https://github.com/Kotlin/dukat",target:"_blank",rel:"noopener noreferrer"},B=n("p",null,"Fortunately for us, the next PW uses Express for which we can find an external type declaration.",-1),K=n("h3",{id:"pw-rest-api-with-kotlin-js-and-express",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#pw-rest-api-with-kotlin-js-and-express","aria-hidden":"true"},"#"),s(" PW: Rest API with Kotlin/JS and Express")],-1),M=n("li",null,"In IntelliJ, create a new nodejs project",-1),O=n("strong",null,"build.gradle.ts",-1),D=n("li",null,[s("Set the kotlin version to the latest one in the "),n("code",null,'kotlin("js")'),s(" line")],-1),L={href:"https://expressjs.com/",target:"_blank",rel:"noopener noreferrer"},N=n("strong",null,"Express",-1),V={href:"https://github.com/chrisnkrueger/kotlin-express",target:"_blank",rel:"noopener noreferrer"},W=n("code",null,"useCommonJs()",-1),H=n("code",null,"js",-1),X={href:"https://github.com/Kotlin/dukat/issues/106",target:"_blank",rel:"noopener noreferrer"},Y={href:"https://github.com/chrisnkrueger/kotlin-express",target:"_blank",rel:"noopener noreferrer"},F=e(`<div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token function">implementation</span><span class="token punctuation">(</span><span class="token function">npm</span><span class="token punctuation">(</span><span class="token string">&quot;express&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;&gt; 4.0.0 &lt; 5.0.0&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">implementation</span><span class="token punctuation">(</span><span class="token string">&quot;dev.chriskrueger:kotlin-express:1.2.0&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>Modify <strong>main.kt</strong> as follows. This created a REST API server that listens to port 3000 and provides a <strong>GET /hello</strong> endpoint</li></ul><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code><span class="token keyword">data</span> <span class="token keyword">class</span> <span class="token function">Message</span><span class="token punctuation">(</span><span class="token keyword">val</span> id<span class="token operator">:</span> Int<span class="token punctuation">,</span> <span class="token keyword">val</span> message<span class="token operator">:</span> String<span class="token punctuation">)</span>

<span class="token keyword">fun</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">val</span> messages <span class="token operator">=</span> <span class="token function">listOf</span><span class="token punctuation">(</span><span class="token function">Message</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">&quot;I love Kotlin/JS&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">val</span> app <span class="token operator">=</span> express<span class="token punctuation">.</span><span class="token function">Express</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;/hello&quot;</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span> req<span class="token punctuation">,</span> res <span class="token operator">-&gt;</span>
        res<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>messages<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;server start at port 3000&quot;</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,3),Z=n("li",null,[s("Run the task "),n("code",null,"nodeRun"),s(" from IntelliJ of from the command line (if you have Gradle installed) "),n("ul",null,[n("li",null,[s("If you encounter an error with Yarn lock, please run the task "),n("code",null,"kotlinUpgradeYarnLock"),s(" and try again")])])],-1),U=n("li",null,"Add POST, PUT and DELETE endpoints",-1),z=n("code",null,"req.body",-1),Q=n("strong",null,"body parser",-1),$=n("li",null,[s("For a JSON body, we need to call "),n("code",null,"app.use(bodyParser.json())"),s(".")],-1),nn={href:"https://www.npmjs.com/package/body-parser",target:"_blank",rel:"noopener noreferrer"},sn=n("strong",null,"bodyParser",-1),an={href:"https://github.com/chrisnkrueger/kotlin-express",target:"_blank",rel:"noopener noreferrer"},tn=n("strong",null,"bodyParser",-1),en={href:"https://www.npmjs.com/package/body-parser?activeTab=code",target:"_blank",rel:"noopener noreferrer"},on={href:"https://github.com/worldline/learning-kotlin/blob/main/material/kotlin-nodejs-demo/src/main/kotlin/BodyParser.kt",target:"_blank",rel:"noopener noreferrer"},ln=n("h2",{id:"spring-framework",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#spring-framework","aria-hidden":"true"},"#"),s(" Spring framework")],-1),pn=n("p",null,"Spring is a famous framework for developing server-side applications: APIs, server generated web pages, microservices, etc. It relies on the the Java ecosystem to build and run, thus making it compatible with Kotlin. Even better, Spring officially supports Kotlin. It even allows in start a new project with Kotlin and Gradle-Kotlin. In the next section, we'll use this starter to recreate our above REST API with Spring.",-1),rn=n("h3",{id:"pw-spring-boot-part-1-develop-the-same-api-with-spring-boot",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#pw-spring-boot-part-1-develop-the-same-api-with-spring-boot","aria-hidden":"true"},"#"),s(" PW: Spring boot part 1 - develop the same API with Spring Boot")],-1),cn={href:"https://start.spring.io/",target:"_blank",rel:"noopener noreferrer"},un=n("li",null,"Choose Kotlin as the language and Kotlin-Grade as the project manager.",-1),dn=n("li",null,[s("Add these dependencies: "),n("strong",null,"Spring Web"),s(" and "),n("strong",null,"Spring Boot DevTools"),s(".")],-1),kn={href:"https://marketplace.visualstudio.com/search?term=kotlin&target=VSCode&category=All%20categories&sortBy=Relevance",target:"_blank",rel:"noopener noreferrer"},mn={href:"https://marketplace.visualstudio.com/items?itemName=Pivotal.vscode-boot-dev-pack",target:"_blank",rel:"noopener noreferrer"},vn=n("li",null,[s("Check that plugins part "),n("code",null,"build.gradle.kts"),s(" uses the latest version of Kotlin. Here is what is should look like with with Kotlin "),n("em",null,"1.8.10"),s(":")],-1),gn=e(`<div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code>plugins <span class="token punctuation">{</span>
	<span class="token function">id</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;org.springframework.boot&quot;</span></span><span class="token punctuation">)</span> version <span class="token string-literal singleline"><span class="token string">&quot;3.0.4&quot;</span></span>
	<span class="token function">id</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;io.spring.dependency-management&quot;</span></span><span class="token punctuation">)</span> version <span class="token string-literal singleline"><span class="token string">&quot;1.1.0&quot;</span></span>
	<span class="token function">kotlin</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;jvm&quot;</span></span><span class="token punctuation">)</span> version <span class="token string-literal singleline"><span class="token string">&quot;1.8.10&quot;</span></span>
	<span class="token function">kotlin</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;plugin.spring&quot;</span></span><span class="token punctuation">)</span> version <span class="token string-literal singleline"><span class="token string">&quot;1.8.10&quot;</span></span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),hn=e("<li>Create the same <code>Customer</code> data class in the <code>model</code> package withotut the <code>@Serializable</code> annotation.</li><li>Create a <code>controller</code> package that contains a <code>CustomerController</code> class which provides a CRUD using a global list. You can find a skeleton below. <ul><li>💡 In Spring, Rest controllers serve the purpose of Ktor routes, where a controller defines a REST resource.</li></ul></li><li>Define the same endpoints as in the previous PW.</li><li>Start the REST API server by running: <ul><li>On Powershell: <code>.\\gradlew.bat bootRun</code></li><li>Any Unix shell: <code>.\\gradlew bootRun</code></li><li>IntelliJ already provides run configurations for spring boot projects.</li></ul></li>",4),bn={href:"https://github.com/worldline/learning-kotlin/blob/main/material/spring-boot-kt-api/customer.jetbrains.http",target:"_blank",rel:"noopener noreferrer"},fn={href:"https://github.com/worldline/learning-kotlin/blob/main/material/spring-boot-kt-api/customer.vscode-resclient.http",target:"_blank",rel:"noopener noreferrer"},yn=e(`<details class="custom-container details"><summary>CustomerController.kt</summary><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code><span class="token keyword">val</span> store <span class="token operator">=</span> mutableListOf<span class="token operator">&lt;</span>Customer<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token annotation builtin">@RestController</span>
<span class="token annotation builtin">@RequestMapping</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;/customer&quot;</span></span><span class="token punctuation">)</span>
<span class="token keyword">class</span> CustomerController <span class="token punctuation">{</span>
    <span class="token annotation builtin">@GetMapping</span>
    <span class="token keyword">fun</span> <span class="token function">getAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> store

    <span class="token annotation builtin">@GetMapping</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;{id}&quot;</span></span><span class="token punctuation">)</span>
    <span class="token keyword">fun</span> <span class="token function">getById</span><span class="token punctuation">(</span><span class="token annotation builtin">@PathVariable</span> id<span class="token operator">:</span> String<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* TODO: implement */</span> <span class="token punctuation">}</span>

    <span class="token annotation builtin">@PostMapping</span>
    <span class="token keyword">fun</span> <span class="token function">addOne</span><span class="token punctuation">(</span><span class="token annotation builtin">@RequestBody</span> customer<span class="token operator">:</span> Customer<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* TODO: implement */</span> <span class="token punctuation">}</span>

    <span class="token annotation builtin">@DeleteMapping</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;{id}&quot;</span></span><span class="token punctuation">)</span>
    <span class="token keyword">fun</span> <span class="token function">deleteOne</span><span class="token punctuation">(</span><span class="token annotation builtin">@PathVariable</span> id<span class="token operator">:</span> String<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* TODO: implement */</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></details><div class="custom-container tip"><p class="custom-container-title">Models or model package ? plural or not ?</p><p>Both are ok as long as you follow the same convention in the project.</p></div><h3 id="pw-spring-boot-part-2-adding-a-database" tabindex="-1"><a class="header-anchor" href="#pw-spring-boot-part-2-adding-a-database" aria-hidden="true">#</a> PW: Spring boot part 2 - adding a database</h3><p>Let&#39;s go a little bit further by storing data in a database and writing some tests.</p><p>We&#39;ll use the H2 in-memory database for the sake of simplicity, since it does not require a server to run. Classes will mapped to database tables with JPA annotations. The database API we&#39;ll be using is called <code>JPARepository</code>. It is a lightweight API that provides common CRUD features by just defining an interface.</p><p>On the testing side, we&#39;ll see two different syntaxes. The default one that is more familiar with Java style and the DSL one which is more readable and more familiar with Kotlin developers.</p>`,6),_n={href:"https://start.spring.io/",target:"_blank",rel:"noopener noreferrer"},wn=e("<li>Open the project and add this class in the <code>model</code> package <code>@Entity class Product(@Id @GeneratedValue var id: Long? = null, var name: String, var price: Int)</code>. This single defines the class as well as the minimal JPA annotations (<code>@Entity</code>, <code>@Id</code> and <code>@GeneratedValue</code>) to generate the corresponding table.</li><li>In the <code>repository</code> package, declare the <code>ProductRepository</code> interface as follows <code>interface ProductRepository: JpaRepository&lt;Product, Long&gt;</code>. This is enough for Spring to generate an implementation with common features as we&#39;ll see later.</li><li>Next, create a <code>ProductService</code> class which will contain the business logic. In terms of architecture, the controller calls a service which in turn rely on other services or repositories.</li>",3),qn=e(`<details class="custom-container details"><summary>ProductService.kt</summary><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code><span class="token annotation builtin">@Service</span>
<span class="token keyword">class</span> <span class="token function">ProductService</span><span class="token punctuation">(</span><span class="token annotation builtin">@Autowired</span> <span class="token keyword">val</span> productRepository<span class="token operator">:</span> ProductRepository<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">fun</span> <span class="token function">getAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> productRepository<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token comment">// use findByIdOrNull instad of findById because the latter returns an optional&lt;Product&gt; instead of Product?</span>
    <span class="token keyword">fun</span> <span class="token function">getById</span><span class="token punctuation">(</span>id<span class="token operator">:</span> Long<span class="token punctuation">)</span> <span class="token operator">=</span> productRepository<span class="token punctuation">.</span><span class="token function">findByIdOrNull</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></details><ul><li>In the controller package, create a <code>ProductController</code> class that is mapped to <code>/product</code> and injects the with <code>@Autowired</code>. Reply to <code>@Get</code> as follows.</li></ul><details class="custom-container details"><summary>ProductController.kt</summary><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code><span class="token annotation builtin">@RestController</span>
<span class="token annotation builtin">@RequestMapping</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;/product&quot;</span></span><span class="token punctuation">)</span>
<span class="token keyword">class</span> <span class="token function">ProductController</span><span class="token punctuation">(</span><span class="token annotation builtin">@Autowired</span> <span class="token keyword">val</span> productService<span class="token operator">:</span> ProductService<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token annotation builtin">@GetMapping</span> <span class="token keyword">fun</span> <span class="token function">getAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> productService<span class="token punctuation">.</span><span class="token function">getAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token annotation builtin">@GetMapping</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;{id}&quot;</span></span><span class="token punctuation">)</span>
    <span class="token keyword">fun</span> <span class="token function">getById</span><span class="token punctuation">(</span><span class="token annotation builtin">@PathVariable</span> id<span class="token operator">:</span> Long<span class="token punctuation">)</span> <span class="token operator">=</span>
        productService<span class="token punctuation">.</span><span class="token function">getById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token operator">?:</span> <span class="token keyword">throw</span> <span class="token function">ResponseStatusException</span><span class="token punctuation">(</span>HttpStatus<span class="token punctuation">.</span>NOT_FOUND<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></details>`,3),Sn={class:"custom-container tip"},In=e(`<p class="custom-container-title">Kotlin makes getById(@PathVariable id: Long) more concise</p><p>The Elvis operator <code>?:</code> allows to simplify the code. Here is a longer version as reference.</p><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code><span class="token annotation builtin">@GetMapping</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">&quot;{id}&quot;</span></span><span class="token punctuation">)</span>
<span class="token keyword">fun</span> <span class="token function">getById</span><span class="token punctuation">(</span><span class="token annotation builtin">@PathVariable</span> id<span class="token operator">:</span> Long<span class="token punctuation">)</span><span class="token operator">:</span> Product <span class="token punctuation">{</span>
    <span class="token keyword">val</span> product <span class="token operator">=</span> productService<span class="token punctuation">.</span><span class="token function">getById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>product <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> product
    <span class="token punctuation">}</span>
    <span class="token keyword">throw</span> <span class="token function">ResponseStatusException</span><span class="token punctuation">(</span>HttpStatus<span class="token punctuation">.</span>NOT_FOUND<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,3),xn=n("code",null,"@ControllerAdvice",-1),Cn={href:"https://spring.io/guides/tutorials/rest/",target:"_blank",rel:"noopener noreferrer"},Tn=e(`<ul><li>Let&#39;s run the project. Before running the project, we need to add a plugin that allows Kotlin classes to generate a default constructor <code>id(&quot;org.jetbrains.kotlin.plugin.jpa&quot;) version &quot;1.8.10&quot;</code>. The plugins should look as follows:</li></ul><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>plugins <span class="token punctuation">{</span>
    <span class="token function">id</span><span class="token punctuation">(</span><span class="token string">&quot;org.jetbrains.kotlin.plugin.jpa&quot;</span><span class="token punctuation">)</span> version <span class="token string">&quot;1.8.10&quot;</span>
	<span class="token function">id</span><span class="token punctuation">(</span><span class="token string">&quot;org.springframework.boot&quot;</span><span class="token punctuation">)</span> version <span class="token string">&quot;3.0.4&quot;</span>
	<span class="token function">id</span><span class="token punctuation">(</span><span class="token string">&quot;io.spring.dependency-management&quot;</span><span class="token punctuation">)</span> version <span class="token string">&quot;1.1.0&quot;</span>
	<span class="token function">kotlin</span><span class="token punctuation">(</span><span class="token string">&quot;jvm&quot;</span><span class="token punctuation">)</span> version <span class="token string">&quot;1.8.10&quot;</span>
	<span class="token function">kotlin</span><span class="token punctuation">(</span><span class="token string">&quot;plugin.spring&quot;</span><span class="token punctuation">)</span> version <span class="token string">&quot;1.8.10&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>As an exercise, implement these endpoints: POST a single product, DELETE by id (<code>/product/{id}</code>) and GET by id (<code>/product/{id}</code>). <ul><li>Hint: <code>ProductController</code> already provides the necessary methods.</li></ul></li><li>Call the different endpoints with a REST client.</li></ul><h3 id="pw-spring-boot-part-2-adding-tests" tabindex="-1"><a class="header-anchor" href="#pw-spring-boot-part-2-adding-tests" aria-hidden="true">#</a> PW: Spring boot part 2 - adding tests</h3><p>Spring frameworks helps perform different types of tests by providing different classes out of the box:</p><ul><li>Unit testing of services, repositories and the REST API. This is done through mock utilities such as <code>MockMVC</code>.</li><li>Integration testing of the REST API using <code>TestRestTemplate</code>. In this situation, a full server is run and tested.</li></ul><p>Most, if not all classes provided by Spring provide an elegant syntax for Java developers. Some of them go further by taking advantage of Kotlin specific features. In the following, we&#39;re going to focus on parts that provide Kotlin DSLs, namely unit testing the REST API with <code>MockMVC</code>.</p><ul><li>Create a test class <code>ProductControllerUnitTests</code> with this initial content. <code>MockMvc</code> allows to unit test the REST API. The <code>@AutoConfigureMockMvc</code> annotation allows spring to configure it automatically</li></ul><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code><span class="token annotation builtin">@SpringBootTest</span>
<span class="token annotation builtin">@AutoConfigureMockMvc</span>
<span class="token keyword">class</span> <span class="token function">ProductControllerTests</span><span class="token punctuation">(</span>
    <span class="token annotation builtin">@Autowired</span> <span class="token keyword">val</span> mockMvc<span class="token operator">:</span> MockMvc<span class="token punctuation">,</span>
    <span class="token annotation builtin">@Autowired</span> <span class="token keyword">val</span> productRepository<span class="token operator">:</span> ProductRepository<span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token annotation builtin">@BeforeEach</span>
    <span class="token keyword">fun</span> <span class="token function">reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        productRepository<span class="token punctuation">.</span><span class="token function">deleteAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>Add these two tests. The first one uses a classic approach while the second take advantage of Kotlin DSL capabilities. In addition to that, we name using a more readable string literal</li></ul>`,10),Pn=n("div",{class:"language-kotlin line-numbers-mode","data-ext":"kt"},[n("pre",{class:"language-kotlin"},[n("code",null,[n("span",{class:"token annotation builtin"},"@Test"),s(`
`),n("span",{class:"token keyword"},"fun"),s(),n("span",{class:"token function"},"testWithClassicApproach"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"{"),s(`
    mockMvc`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"perform"),n("span",{class:"token punctuation"},"("),n("span",{class:"token keyword"},"get"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string-literal singleline"},[n("span",{class:"token string"},'"/product"')]),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(`
        `),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"andExpect"),n("span",{class:"token punctuation"},"("),n("span",{class:"token function"},"status"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),s("isOk"),n("span",{class:"token punctuation"},")"),s(`
        `),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"andExpect"),n("span",{class:"token punctuation"},"("),n("span",{class:"token function"},"content"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"string"),n("span",{class:"token punctuation"},"("),n("span",{class:"token function"},"containsString"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string-literal singleline"},[n("span",{class:"token string"},'"[]"')]),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},")"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),An=n("div",{class:"language-kotlin line-numbers-mode","data-ext":"kt"},[n("pre",{class:"language-kotlin"},[n("code",null,[n("span",{class:"token annotation builtin"},"@Test"),s(`
`),n("span",{class:"token keyword"},"fun"),s(),n("span",{class:"token function"},"`test GET a single product`"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(`
    mockMvc`),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"get"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string-literal singleline"},[n("span",{class:"token string"},'"/product/1"')]),n("span",{class:"token punctuation"},")"),n("span",{class:"token punctuation"},"."),n("span",{class:"token function"},"andExpect"),s(),n("span",{class:"token punctuation"},"{"),s(`
        status `),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token function"},"isOk"),n("span",{class:"token punctuation"},"("),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"}"),s(`
        `),n("span",{class:"token function"},"jsonPath"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string-literal singleline"},[n("span",{class:"token string"},'"$.name"')]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token function"},"value"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string-literal singleline"},[n("span",{class:"token string"},'"A"')]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"}"),s(`
        `),n("span",{class:"token function"},"jsonPath"),n("span",{class:"token punctuation"},"("),n("span",{class:"token string-literal singleline"},[n("span",{class:"token string"},'"$.price"')]),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token function"},"value"),n("span",{class:"token punctuation"},"("),n("span",{class:"token number"},"1"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"}"),s(`
        content `),n("span",{class:"token punctuation"},"{"),s(),n("span",{class:"token function"},"contentType"),n("span",{class:"token punctuation"},"("),s("MediaType"),n("span",{class:"token punctuation"},"."),s("APPLICATION_JSON"),n("span",{class:"token punctuation"},")"),s(),n("span",{class:"token punctuation"},"}"),s(`
    `),n("span",{class:"token punctuation"},"}"),s(`
`),n("span",{class:"token punctuation"},"}"),s(`
`)])]),n("div",{class:"line-numbers","aria-hidden":"true"},[n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"}),n("div",{class:"line-number"})])],-1),jn=n("ul",null,[n("li",null,"As an exercise, unit tests for the other endpoints.")],-1),Rn={class:"custom-container tip"},En=e(`<p class="custom-container-title">The request builder of JpaRepository</p><p>Spring repositories implement requests based on the name of their methods. For example, to get all products sorted by name, we can add this method to the interface.</p><div class="language-kotlin line-numbers-mode" data-ext="kt"><pre class="language-kotlin"><code><span class="token keyword">interface</span> ProductRepository<span class="token operator">:</span> JpaRepository<span class="token operator">&lt;</span>Product<span class="token punctuation">,</span> Long<span class="token operator">&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">fun</span> <span class="token function">findAllByOrderByNameAsc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> List<span class="token operator">&lt;</span>Product<span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,3),Gn={href:"https://docs.spring.io/spring-data/jpa/docs/current/reference/html/#repositories.query-methods.query-creation",target:"_blank",rel:"noopener noreferrer"},Jn=n("h3",{id:"completed-projects",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#completed-projects","aria-hidden":"true"},"#"),s(" Completed projects")],-1),Bn={href:"https://github.com/worldline/learning-kotlin/tree/master/material/ktor-api",target:"_blank",rel:"noopener noreferrer"},Kn={href:"https://github.com/worldline/learning-kotlin/tree/master/material/spring-boot-kt-api",target:"_blank",rel:"noopener noreferrer"},Mn=n("h2",{id:"going-further",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#going-further","aria-hidden":"true"},"#"),s(" Going further")],-1),On=n("p",null,"These official tutorials go even further:",-1),Dn={href:"https://kotlinlang.org/docs/jvm-spring-boot-restful.html",target:"_blank",rel:"noopener noreferrer"},Ln={href:"https://spring.io/guides/tutorials/spring-boot-kotlin/",target:"_blank",rel:"noopener noreferrer"},Nn={href:"https://spring.io/guides/tutorials/rest/",target:"_blank",rel:"noopener noreferrer"},Vn={href:"https://quarkus.io/guides/kotlin",target:"_blank",rel:"noopener noreferrer"},Wn=n("h2",{id:"links-and-references",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#links-and-references","aria-hidden":"true"},"#"),s(" Links and references")],-1),Hn={href:"https://dev.to/mpetuska/js-in-kotlinjs-c4g",target:"_blank",rel:"noopener noreferrer"},Xn={href:"https://www.baeldung.com/kotlin/mockmvc-kotlin-dsl",target:"_blank",rel:"noopener noreferrer"},Yn={href:"https://spring.io/guides/tutorials/spring-boot-kotlin/",target:"_blank",rel:"noopener noreferrer"},Fn={href:"https://www.baeldung.com/kotlin/jpa",target:"_blank",rel:"noopener noreferrer"},Zn={href:"https://stackoverflow.com/questions/47143127/spring-data-jpa-how-to-use-kotlin-nulls-instead-of-optional",target:"_blank",rel:"noopener noreferrer"},Un=n("h1",{id:"break-10min",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#break-10min","aria-hidden":"true"},"#"),s(" Break (10min)")],-1);function zn(Qn,$n){const t=o("ExternalLinkIcon"),l=o("CodeGroupItem"),p=o("CodeGroup");return c(),u("div",null,[k,n("p",null,[s("Many frameworks officially support Kotlin: "),n("a",m,[s("Spring"),a(t)]),s(", "),n("a",v,[s("Quarkus"),a(t)]),s(", "),n("a",g,[s("Ktor"),a(t)]),s(", among others "),n("a",h,[s("listed here"),a(t)]),s(".")]),n("p",null,[s("In addition to that, Kotlin is theoretically compatible with any framework that targets the JVM or JS. For example, this tutorial shows "),n("a",b,[s("how to use nodejs with Kotlin"),a(t)]),s(". However, frameworks that do not officially support Kotlin may require some tweaking to use it.")]),f,y,_,n("ul",null,[n("li",null,[s("Create a project on "),n("a",w,[s("start.ktor.io"),a(t)]),s(" with the following plugins: ContentNegotiation, kotlinx.serialization, and Routing.")]),q]),S,n("div",I,[x,n("p",null,[n("a",C,[s("This code runs another example"),a(t)]),s(".")])]),T,n("p",null,[n("a",P,[s("This page has detailed steps"),a(t)])]),A,j,n("p",null,[s("We can even import npm libraries as long as you declare the JS API surface that you'll be using in Kotlin. This is called "),R,s(" (You can think of it as an equivalent of TypeScript's type definitions) that declares the symbols that we want to access in Kotlin thanks to "),n("a",E,[s("@JsModule"),a(t)]),s(" and "),n("a",G,[s("@JsNonModule"),a(t)]),s(" annotations. Defining such external declarations can be a hassle and there seems to be no official automatic generator ("),n("a",J,[s("dukat"),a(t)]),s(" has been removed in kotlin 1.8.20). In that case, we have two options, either write the external declaration or import it as a dependency if available.")]),B,K,n("ul",null,[M,n("li",null,[s("Once the project is loaded, edit "),O,s(" as follows: "),n("ul",null,[D,n("li",null,[s("Add these two dependencies. The first one is the "),n("a",L,[N,a(t)]),s(" library and the second one is it external definitions provided by "),n("a",V,[s("chrisnkrueger/kotlin-express"),a(t)]),s(".")]),n("li",null,[s("add a "),W,s(" line inside the the "),H,s(" block. This "),n("a",X,[s("is required"),a(t)]),s(" to be able to use "),n("a",Y,[s("chrisnkrueger/kotlin-express"),a(t)]),s(" in our code.")])])])]),F,n("ul",null,[Z,U,n("li",null,[s("Regarding the POST body, Express leaves "),z,s(" undefined unless we specify a "),Q,s(". "),n("ul",null,[$,n("li",null,[n("a",nn,[sn,a(t)]),s(" is an npm library and unfortunately, "),n("a",an,[s("chrisnkrueger/kotlin-express"),a(t)]),s(" does not provide an external definition for "),tn,s(" as of version 1.2.0.")]),n("li",null,[s("Can you try to define it yourself by reading the "),n("a",en,[s("library's code"),a(t)]),s(" ?")]),n("li",null,[s("You can find a solution "),n("a",on,[s("here"),a(t)])])])])]),ln,pn,rn,n("ul",null,[n("li",null,[s("Create a project on "),n("a",cn,[s("start.spring.io (also called Spring initializr)"),a(t)]),s(" with the following dependencies: Spring Web and Spring Boot DevTools.")]),un,dn,n("li",null,[s('Click on "Generate". Download the archive, unzip it, and open the project with IntelliJ (preferably) or VSCode. '),n("ul",null,[n("li",null,[s("For VSCode, install a "),n("a",kn,[s("Kotlin extension"),a(t)]),s(" and "),n("a",mn,[s("Spring Boot Extension Pack"),a(t)]),s(" ( ⚠️ Spring extension do not seem to support kotlin).")])])]),vn]),gn,n("ul",null,[hn,n("li",null,[s("Please test the endpoints with a REST client. You can find http files here in "),n("a",bn,[s("JetBrains format"),a(t)]),s(" or "),n("a",fn,[s("VSCode's REST Client extension"),a(t)])])]),yn,n("ul",null,[n("li",null,[s("Create a new Spring project using "),n("a",_n,[s("Spring initializr"),a(t)]),s(" with Kotlin and the following dependencies: Spring Data JPA, H2 Database, Spring Boot DevTools, Spring Web")]),wn]),qn,n("div",Sn,[In,n("p",null,[s("In addition to that, Spring provides "),xn,s(" to change the exception message. You can see an "),n("a",Cn,[s("example here"),a(t)]),s(".")])]),Tn,a(p,null,{default:i(()=>[a(l,{title:"Without DSL (Test Get All)"},{default:i(()=>[Pn]),_:1}),a(l,{title:"With DSL (Test Get Single)"},{default:i(()=>[An]),_:1})]),_:1}),jn,n("div",Rn,[En,n("p",null,[n("a",Gn,[s("The official documentation"),a(t)]),s(" provides more detailed explanations and examples.")])]),Jn,n("ul",null,[n("li",null,[n("a",Bn,[s("ktor Rest API"),a(t)])]),n("li",null,[n("a",Kn,[s("Spring boot Rest API"),a(t)])])]),Mn,On,n("ul",null,[n("li",null,[n("a",Dn,[s("This tutorial from kotlinlang"),a(t)]),s(" shows how to create a RESTful web service with a database using Spring Boot.")]),n("li",null,[n("a",Ln,[s("This one from spring.io"),a(t)]),s(" show how to build a web application with Spring Boot and Kotlin.")]),n("li",null,[n("a",Nn,[s("Rest ÄPIs with Spring"),a(t)])]),n("li",null,[n("a",Vn,[s("Quarkus and kotlin"),a(t)])])]),Wn,n("ul",null,[n("li",null,[n("a",Hn,[s("JS in Kotlin/JS"),a(t)])]),n("li",null,[n("a",Xn,[s("mockmvc kotlin dsl"),a(t)])]),n("li",null,[n("a",Yn,[s("spring-boot-kotlin tutorial"),a(t)])]),n("li",null,[n("a",Fn,[s("Working with Kotlin and JPA"),a(t)])]),n("li",null,[n("a",Zn,[s("Spring Data JPA How to use Kotlin nulls instead of Optional"),a(t)])])]),Un])}const ss=r(d,[["render",zn],["__file","index.html.vue"]]);export{ss as default};
